<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animiertes Tachometer</title>
    <style>
        /* CSS für das Layout und den Stil des Tachometers */

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }

        .tachometer-container {
            position: relative;
            width: 300px;
            height: 150px;
            overflow: hidden; /* Verhindert, dass die Nadel außerhalb des Kreises sichtbar ist */
            border-radius: 150px 150px 0 0;
            background-color: #333;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
        }

        .tacho-gauge {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 300px;
            border-radius: 50%;
            border: 15px solid #222;
            background-color: #111;
        }

        .tacho-needle {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform-origin: bottom center; /* Wichtig: Dreht sich um den unteren Mittelpunkt */
            height: 140px;
            width: 4px;
            background-color: red;
            border-radius: 2px 2px 0 0;
            z-index: 10;
            /* Startposition: -120 Grad (entspricht 0 km/h) */
            transform: translateX(-50%) rotate(-120deg);
            transition: transform 0.1s ease-out; /* Weiche Bewegung der Nadel */
        }

        .tacho-center {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background-color: red;
            border-radius: 50%;
            z-index: 15;
            border: 3px solid #fff;
        }

        .speed-display {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 3em;
            font-weight: bold;
            z-index: 5;
        }

        .unit {
            position: absolute;
            top: 80%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ccc;
            font-size: 0.8em;
            z-index: 5;
        }

        .button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

    <div class="tachometer-container">
        <div class="tacho-gauge">
            <div class="speed-display" id="speed">0</div>
            <div class="unit">km/h</div>
        </div>
        <div class="tacho-needle" id="needle"></div>
        <div class="tacho-center"></div>
    </div>

    <button class="button" onclick="startSimulation()">Starte Beschleunigung</button>

    <script>
        // JavaScript für die Logik der Simulation

        const needle = document.getElementById('needle');
        const speedDisplay = document.getElementById('speed');
        let currentSpeed = 0;
        let animationFrameId;
        const maxSpeed = 100;

        /**
         * Konvertiert die Geschwindigkeit (0-100) in einen Drehwinkel für die Nadel.
         * Der Bereich soll von -120 Grad (0 km/h) bis +30 Grad (100 km/h) gehen.
         * Gesamtdrehung: 150 Grad.
         * @param {number} speed - Die aktuelle Geschwindigkeit in km/h.
         * @returns {number} Der entsprechende Drehwinkel in Grad.
         */
        function getRotation(speed) {
            const minAngle = -120; // Winkel bei 0 km/h
            const maxAngle = 30;    // Winkel bei 100 km/h
            const angleRange = maxAngle - minAngle; // 150 Grad
            
            // Speed als Prozentsatz der maximalen Geschwindigkeit (0 bis 1)
            const percentage = speed / maxSpeed;

            // Berechnet den aktuellen Winkel
            return minAngle + (percentage * angleRange);
        }

        /**
         * Aktualisiert die Nadelposition und die Geschwindigkeitsanzeige.
         * @param {number} speed - Die neue Geschwindigkeit in km/h.
         */
        function updateTachometer(speed) {
            currentSpeed = Math.round(speed); // Rundet die Geschwindigkeit auf ganze Zahlen
            
            // Nadel drehen
            const rotation = getRotation(currentSpeed);
            needle.style.transform = `translateX(-50%) rotate(${rotation}deg)`;

            // Geschwindigkeitsanzeige aktualisieren
            speedDisplay.textContent = currentSpeed;
        }


        /**
         * Führt die Beschleunigungs- und Abbremssimulation durch.
         */
        function startSimulation() {
            // Stoppt eine laufende Animation, falls vorhanden
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
            }
            
            let startTime = null;
            const accelerationTime = 3000; // 3 Sekunden für 0 auf 100
            const decelerationTime = 2000; // 2 Sekunden für 100 auf 0
            
            let phase = 'acceleration'; // Aktuelle Phase: 'acceleration' oder 'deceleration'

            function animate(timestamp) {
                if (!startTime) startTime = timestamp;
                const elapsedTime = timestamp - startTime;

                if (phase === 'acceleration') {
                    // Beschleunigungsphase
                    const progress = Math.min(1, elapsedTime / accelerationTime);
                    const speed = progress * maxSpeed;
                    updateTachometer(speed);

                    if (progress < 1) {
                        // Animation fortsetzen
                        animationFrameId = requestAnimationFrame(animate);
                    } else {
                        // Beschleunigung beendet, Phase wechseln
                        phase = 'deceleration';
                        startTime = null; // Startzeit für die Abbremsung zurücksetzen
                        animationFrameId = requestAnimationFrame(animate);
                    }

                } else if (phase === 'deceleration') {
                    // Abbremsphase
                    const progress = Math.min(1, elapsedTime / decelerationTime);
                    // Speed von 100 auf 0
                    const speed = maxSpeed * (1 - progress); 
                    updateTachometer(speed);

                    if (progress < 1) {
                        // Animation fortsetzen
                        animationFrameId = requestAnimationFrame(animate);
                    } else {
                        // Abbremsung beendet
                        updateTachometer(0); // Stellt sicher, dass die Geschwindigkeit genau 0 ist
                        animationFrameId = undefined;
                    }
                }
            }

            // Startet die Animationsschleife
            animationFrameId = requestAnimationFrame(animate);
        }

    </script>
</body>
</html>